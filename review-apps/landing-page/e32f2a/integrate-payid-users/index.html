<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-148411216-7"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-148411216-7",{})</script>
<link rel="search" type="application/opensearchdescription+xml" title="PayID Developer Documentation and Reference Guides" href="/payid-documentation/review-apps/landing-page/e32f2a/opensearch.xml"><title data-react-helmet="true">Integrate Existing User Databases | PayID Developer Documentation and Reference Guides</title><meta data-react-helmet="true" property="og:image" content="http://localhost:3000/payid-documentation/review-apps/landing-page/e32f2a/img/payid.png"><meta data-react-helmet="true" property="twitter:image" content="http://localhost:3000/payid-documentation/review-apps/landing-page/e32f2a/img/payid.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for PayID Developer Documentation and Reference Guides"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Integrate Existing User Databases | PayID Developer Documentation and Reference Guides"><meta data-react-helmet="true" name="description" content="If you have an existing user database, you can take the following steps to integrate PayID functionality into your product."><meta data-react-helmet="true" property="og:description" content="If you have an existing user database, you can take the following steps to integrate PayID functionality into your product."><meta data-react-helmet="true" property="og:url" content="http://localhost:3000/payid-documentation/review-apps/landing-page/e32f2a/integrate-payid-users"><link data-react-helmet="true" rel="shortcut icon" href="/payid-documentation/review-apps/landing-page/e32f2a/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="http://localhost:3000/payid-documentation/review-apps/landing-page/e32f2a/integrate-payid-users"><link rel="stylesheet" href="/payid-documentation/review-apps/landing-page/e32f2a/styles.98f1722e.css">
<link rel="preload" href="/payid-documentation/review-apps/landing-page/e32f2a/styles.e8344204.js" as="script">
<link rel="preload" href="/payid-documentation/review-apps/landing-page/e32f2a/runtime~main.0373c2f6.js" as="script">
<link rel="preload" href="/payid-documentation/review-apps/landing-page/e32f2a/main.b7edf129.js" as="script">
<link rel="preload" href="/payid-documentation/review-apps/landing-page/e32f2a/1.5ba717da.js" as="script">
<link rel="preload" href="/payid-documentation/review-apps/landing-page/e32f2a/2.70959adc.js" as="script">
<link rel="preload" href="/payid-documentation/review-apps/landing-page/e32f2a/36.14f3338b.js" as="script">
<link rel="preload" href="/payid-documentation/review-apps/landing-page/e32f2a/39.52e456a0.js" as="script">
<link rel="preload" href="/payid-documentation/review-apps/landing-page/e32f2a/80b3e434.1512356f.js" as="script">
<link rel="preload" href="/payid-documentation/review-apps/landing-page/e32f2a/17896441.d5523013.js" as="script">
<link rel="preload" href="/payid-documentation/review-apps/landing-page/e32f2a/4eac0ffc.d0c023a0.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top navbarHideable_3046"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a href="http://localhost:8000" target="_self" rel="noopener noreferrer" class="navbar__brand"><img class="navbar__logo" src="/payid-documentation/review-apps/landing-page/e32f2a/img/icon.svg" alt="PayID: Unifying payments through a universal payment identifier to simplify sending and receiving payments"><strong class="navbar__title"></strong></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/payid-documentation/review-apps/landing-page/e32f2a/">Documentation</a><a href="https://api.payid.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Reference</a><a href="http://localhost:8000/contact" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Contact Us</a><a href="https://github.com/payid-org/payid" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-button header-github-link" aria-label="GitHub repository">GitHub repository</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a href="http://localhost:8000" target="_self" rel="noopener noreferrer" class="navbar__brand"><img class="navbar__logo" src="/payid-documentation/review-apps/landing-page/e32f2a/img/icon.svg" alt="PayID: Unifying payments through a universal payment identifier to simplify sending and receiving payments"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/payid-documentation/review-apps/landing-page/e32f2a/">Documentation</a></li><li class="menu__list-item"><a href="https://api.payid.org" target="_blank" rel="noopener noreferrer" class="menu__link">API Reference</a></li><li class="menu__list-item"><a href="http://localhost:8000/contact" target="_blank" rel="noopener noreferrer" class="menu__link">Contact Us</a></li><li class="menu__list-item"><a href="https://github.com/payid-org/payid" target="_blank" rel="noopener noreferrer" class="menu__link github-button header-github-link" aria-label="GitHub repository">GitHub repository</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC sidebarWithHideableNavbar_2IoJ"><a href="http://localhost:8000" target="_self" rel="noopener noreferrer" tabindex="-1" class="sidebarLogo_Snse"><img src="/payid-documentation/review-apps/landing-page/e32f2a/img/icon.svg" alt="PayID: Unifying payments through a universal payment identifier to simplify sending and receiving payments"><strong></strong></a><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/payid-documentation/review-apps/landing-page/e32f2a/">Home</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Get Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/verifiable-payid-tutorial">Get Started with Verifiable PayID</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/ripplex-dev-kit-payid-get-started">Get Started with RippleX Dev Kit and PayID</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/metrics-tutorial">Metrics Tutorial</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Reference Implementation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/payid-documentation/review-apps/landing-page/e32f2a/payid-reference-overview">Reference Implementation Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/payid-documentation/review-apps/landing-page/e32f2a/payid-cli">PayID CLI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/payid-documentation/review-apps/landing-page/e32f2a/verifiable-payid">Enhance Security With Verifiable PayID</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/payid-documentation/review-apps/landing-page/e32f2a/payid-discovery">Discover a PayID</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/payid-documentation/review-apps/landing-page/e32f2a/payid-best-practices">Security Best Practices</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/payid-documentation/review-apps/landing-page/e32f2a/integrate-payid-users">Integrate Existing User Databases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/payid-documentation/review-apps/landing-page/e32f2a/metrics">Metrics</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deployment Options</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/intro-deploy">Deployment Options</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/payid-server-requirements">Server Requirements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/local-deployment">Deploy Locally Without Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/deploy-with-docker">Deploy a PayID Server with Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/aws-lambda-deploy">Deploy on AWS Lambda</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/remote-deployment">Deploy on AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/nginx-ssl-deploy">Set Up NGINX Reverse Proxy and SSL</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">PayID References</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/api-reference">API Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/payid-cli-reference">PayID CLI Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/payid-headers">Headers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/payid-interfaces">Interfaces</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/payid-documentation/review-apps/landing-page/e32f2a/payid-schemas">Schemas</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/payid-documentation/review-apps/landing-page/e32f2a/ripplex-dev-kit-payid">RippleX Dev Kit Integration</a></li><li class="menu__list-item"><a class="menu__link" href="/payid-documentation/review-apps/landing-page/e32f2a/community-resources">Community Resources</a></li><li class="menu__list-item"><a class="menu__link" href="/payid-documentation/review-apps/landing-page/e32f2a/release-notes">Release Notes</a></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Integrate Existing User Databases</h1></header><div class="markdown"><p>If you have an existing user database, you can take the following steps to integrate PayID functionality into your product.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="extend-existing-database-tables-with-new-columns"></a>Extend existing database tables with new columns<a aria-hidden="true" tabindex="-1" class="hash-link" href="#extend-existing-database-tables-with-new-columns" title="Direct link to heading">#</a></h2><p>The PayID <a href="https://github.com/payid-org/payid/blob/master/src/db/schema/01_account.sql" target="_blank" rel="noopener noreferrer">account schema</a> is used to define a table for users.</p><p>The account table contains two fields: <code>id</code> and <code>pay_id</code>. The address table uses a foreign key column called <code>account_id</code> which depends on <code>id</code> as a foreign key to associate addresses with individual accounts. The second column is <code>pay_id</code> which is where we store the string identifier (such as <code>alice$wallet.com</code>).</p><p>With an existing user database, you will need to add the <code>pay_id</code> column. Your user database might already have the equivalent of an <code>id</code> field, but if not, add this column so that each address can reference a specific user.</p><p>The PayID account schema has three constraints that could be useful to apply to your existing user database. Two constraints guarantee that all entered PayIDs are lowercase and are not empty strings. The final and most important constraint is that the regex constraint <a href="https://github.com/payid-org/payid/blob/master/src/db/schema/01_account.sql#L17" target="_blank" rel="noopener noreferrer">valid_pay_id</a> guarantees that all entered PayIDs are in compliance with the format outlined in the <a href="https://payid.org/whitepaper.pdf" target="_blank" rel="noopener noreferrer">PayID whitepaper</a>.</p><p>The PayID <a href="https://github.com/payid-org/payid/blob/master/src/db/schema/02_address.sql" target="_blank" rel="noopener noreferrer">address schema</a> is used to define a table of addresses associated with users.</p><p>Whenever a PayID is queried, the payment network and environment are sent via an Accept header. Therefore, it is important that each address stored has an associated payment network and environment. For example, upon receipt of the accept header <code>application/xrpl-testnet+json</code> you should query your address table for the address associated with the <code>xrpl</code> payment network and <code>testnet</code> environment.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="match-column-names-in-data-access-functions"></a>Match column names in data access functions<a aria-hidden="true" tabindex="-1" class="hash-link" href="#match-column-names-in-data-access-functions" title="Direct link to heading">#</a></h2><p>All functions that query the database are located in <a href="https://github.com/payid-org/payid/tree/master/src/data-access" target="_blank" rel="noopener noreferrer">src/data-access</a>. If you use column names that do not match the <a href="https://github.com/payid-org/payid/tree/master/src/db/schema" target="_blank" rel="noopener noreferrer">schema</a>, then you must reflect those changes in the data access functions. The following table lists the files contained within <a href="https://github.com/payid-org/payid/tree/master/src/data-access" target="_blank" rel="noopener noreferrer">src/data-access</a> and the corresponding column names they use:</p><table><thead><tr><th>File name</th><th align="left">Columns used</th></tr></thead><tbody><tr><td><a href="https://github.com/payid-org/payid/blob/master/src/data-access/payIds.ts" target="_blank" rel="noopener noreferrer">payIds.ts</a></td><td align="left">address.payment_network, address.environment, address.details</td></tr><tr><td><a href="https://github.com/payid-org/payid/blob/master/src/data-access/reports.ts" target="_blank" rel="noopener noreferrer">reports.ts</a></td><td align="left">address.payment_network, address.environment</td></tr><tr><td><a href="https://github.com/payid-org/payid/blob/master/src/data-access/users.ts" target="_blank" rel="noopener noreferrer">users.ts</a></td><td align="left">account.pay_id, account.id, address.account_id, address.payment_network, address.environment, address.details</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="change-the-type-of-database"></a>Change the type of database<a aria-hidden="true" tabindex="-1" class="hash-link" href="#change-the-type-of-database" title="Direct link to heading">#</a></h2><p>The reference implementation described in <a href="/payid-documentation/review-apps/landing-page/e32f2a/">Getting Started</a> uses a Postgres database. To use a different type of database, either update the settings in the <a href="https://github.com/payid-org/payid/blob/master/src/db/knex.ts" target="_blank" rel="noopener noreferrer">knexfile</a>, or replace the use of <code>knex</code> throughout the repository with your preferred database connection tool.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="set-environment-variables"></a>Set environment variables<a aria-hidden="true" tabindex="-1" class="hash-link" href="#set-environment-variables" title="Direct link to heading">#</a></h2><p>PayID depends on environment variables. All of these environment variables are read in <a href="https://github.com/payid-org/payid/blob/master/src/config.ts" target="_blank" rel="noopener noreferrer">src/config.ts</a> and assigned to variables. During integration, look through all of the environment variables used in <a href="https://github.com/payid-org/payid/blob/master/src/config.ts" target="_blank" rel="noopener noreferrer">src/config.ts</a> to ensure all are set properly for your environment.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="update-database-migrations"></a>Update database migrations<a aria-hidden="true" tabindex="-1" class="hash-link" href="#update-database-migrations" title="Direct link to heading">#</a></h2><p>If you use your own database, there are migration files written specifically for the tables outlined in <a href="https://github.com/payid-org/payid/tree/master/src/db/schema" target="_blank" rel="noopener noreferrer">src/db/schema</a>. Either remove these migration files, or update them to match your database.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor" id="update-sql-files"></a>Update SQL files<a aria-hidden="true" tabindex="-1" class="hash-link" href="#update-sql-files" title="Direct link to heading">#</a></h2><p>The <code>.sql</code> files within <a href="https://github.com/payid-org/payid/tree/master/src/db" target="_blank" rel="noopener noreferrer">src/db</a> are each executed by the function <code>syncDatabaseSchema</code> located in <a href="https://github.com/payid-org/payid/blob/master/src/db/syncDatabaseSchema.ts" target="_blank" rel="noopener noreferrer">db/syncDatabaseSchema.ts</a>. To integrate into an existing system, be sure to look through the directories in <a href="https://github.com/payid-org/payid/blob/master/src/db/" target="_blank" rel="noopener noreferrer">src/db</a> to identify any <code>.sql</code> files that you need to modify to fit your existing system, or to remove because they do not apply.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/payid-org/payid-documentation/tree/master/docs/integrate-payid-users.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/payid-documentation/review-apps/landing-page/e32f2a/payid-best-practices"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Security Best Practices</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/payid-documentation/review-apps/landing-page/e32f2a/metrics"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Metrics Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#extend-existing-database-tables-with-new-columns" class="table-of-contents__link">Extend existing database tables with new columns</a></li><li><a href="#match-column-names-in-data-access-functions" class="table-of-contents__link">Match column names in data access functions</a></li><li><a href="#change-the-type-of-database" class="table-of-contents__link">Change the type of database</a></li><li><a href="#set-environment-variables" class="table-of-contents__link">Set environment variables</a></li><li><a href="#update-database-migrations" class="table-of-contents__link">Update database migrations</a></li><li><a href="#update-sql-files" class="table-of-contents__link">Update SQL files</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/payid-documentation/review-apps/landing-page/e32f2a/styles.e8344204.js"></script>
<script src="/payid-documentation/review-apps/landing-page/e32f2a/runtime~main.0373c2f6.js"></script>
<script src="/payid-documentation/review-apps/landing-page/e32f2a/main.b7edf129.js"></script>
<script src="/payid-documentation/review-apps/landing-page/e32f2a/1.5ba717da.js"></script>
<script src="/payid-documentation/review-apps/landing-page/e32f2a/2.70959adc.js"></script>
<script src="/payid-documentation/review-apps/landing-page/e32f2a/36.14f3338b.js"></script>
<script src="/payid-documentation/review-apps/landing-page/e32f2a/39.52e456a0.js"></script>
<script src="/payid-documentation/review-apps/landing-page/e32f2a/80b3e434.1512356f.js"></script>
<script src="/payid-documentation/review-apps/landing-page/e32f2a/17896441.d5523013.js"></script>
<script src="/payid-documentation/review-apps/landing-page/e32f2a/4eac0ffc.d0c023a0.js"></script>
</body>
</html>